- [1. vite nest.js nuxt.js](#1-vite-nestjs-nuxtjs)
- [2. 前端登录鉴权(动态注册路由)](#2-前端登录鉴权(动态注册路由))
- [3. 前端换肤](#3-前端换肤)
- [4. Test](#4-test)
# 1. vite nest.js nuxt.js
 - vite是一个打包工具，跟webpack一样，但是qiankun微前端框架是用的webpack，vite没办法用，以后再学习  
 - nest.js是基于express的node.js做的框架，连接的mysql数据库，然后用的破解版的navicat去直接查看数据库里的数据，现在会开发增删改查的接口，利用本地检验和jwt，实现了用户的登录和token生成，然后利用scoket.io,学会了建立webscoket连接  
:worried:**但是接口拦截器半生不熟 , 然后redis还未学习、微服务、grpc也还没学习**
 - nuxt.js是vue框架，为了用来ssr，优化seo的网页搜索，但是现在做的是内网的，只需要spa就行了，不需要去做seo优化  
**重点就是源代码是不是可以直接看到，这个还是要学习一下的，如果接下来去的是做外网开发**
# 2. 前端登录鉴权（动态注册路由）
1. 用户登录，获取token，将token存在cookie里
- cookie，只有4K，在浏览器关闭的时候会清空
- localStorage，浏览器关闭也不会清空
- sessionStorage，页面关闭就会清空，不同页面不互通
- 所以token要存在cookie里面，这样关闭浏览器，下次就需要重新登录，同一个浏览器，打开多个页面的时候，不需要重复的登录
2. 根据token，通过新的接口获取userinfo，根据userinfo获取对应权限的路由，通过``` router.addRoutes() ```动态挂载这些路由
- userinfo只存在store里，每次刷新页面，就重新根据接口请求
- userinfo存在localstorage里（没有专门的接口，和token一起返回）
- 根据userinfo动态添加路由，并把这些路由存在store里面，因为网页一刷新，router和store就一起初始化了，所以要在```router.beforeEach()```路由守卫的时候判断，如果store里没有存对应的路由，就要重新根据根据userinfo动态添加路由
3. ```router.beforeEach()```路由守卫，先判断是不是白名单，再判断是不是有token，再判断是不是有userinfo
- 把userId在sessionStorage和localstorage都存一下，切换页面的时候，先看sessionStorage有没有userId
- 有，证明是已经打开的页面，判断两个id一不一致，不一致，就退出到登录界面（先登录用户A，再登录用户B）
- 没有，证明是新开的页面，判断是不是有token
# 3. 前端换肤
本质上是利用scss可以使用变量，实现的换肤
```
$themes: (light: $theme-light,dark: $theme-dark,);
$theme-map: null;
@mixin themes {
  // 本质上，就只是map-get($theme-old, 'background-color1')就可以获取对应的属性
  // 利用[data-theme="#{$theme-name}"]把多个theme抽取出对应的theme，其实也可以利用js来获取对应的theme
  @each $theme-name,
  $map in $themes {
    // & 表示父级元素  !global 表示变量是全局的
    [data-theme="#{$theme-name}"] & {
      /* TODO:先清空赋值，再循环合并，似乎性能上更好？待以后css样式多了再测试吧
      $theme-map: () !global;
      // 循环合并键值对
      @each $key,
      $value in $map {
        $theme-map: map-merge($theme-map,
            ($key: $value,
            )) !global;
      } */
      $theme-map: $map !global;
      @content;
    }
  }
}

@function theme($key) {
  @return map-get($theme-map, $key);
}


//获取背景颜色,需要添加!important的给$cont赋值即可
@mixin background_color($color,$cont:null) {
  @include themes {
      background-color: theme($color) $cont;
  }
}
```
# 4. Test
1231231

